<link type="text/css" rel="stylesheet" href="../additional_files/bootstrap.min.css">
<link type="text/css" rel="stylesheet" href="../additional_files/sh_typical.min.css">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$', '$']], displayMath: [['$$', '$$']]}});</script>
<script type="text/javascript" src="../additional_files/MathJax-master/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<h3>题目描述</h3>
<p>scx 学会了一种游戏。在一个置换中，对于 $1$ 到 $n$ 这 $n$ 个数字，都有唯一且不同的 $1$ 到 $n$ 的数字与之对应。</p>
<p>最开始 scx 把数字按顺序 $1, 2, 3, \cdots, n$ 写一排在纸上。然后再在这一排下面写上它们对应的数字。然后又在新的一排下面写上它们对应的数字。如此反复，直到序列再次变为 $1, 2, 3, \cdots, n$。</p>
<p>如：$1, 2, 3, 4, 5, 6$ 对应的关系为 $\dbinom {1 \quad 2 \quad 3 \quad 4 \quad 5 \quad 6} {2 \quad 3 \quad 1 \quad 5 \quad 4 \quad 6}$，则 scx 的操作如下：</p>
<div class="panel-body"><pre>
1 2 3 4 5 6 
2 3 1 5 4 6
3 1 2 4 5 6
1 2 3 5 4 6
2 3 1 4 5 6
3 1 2 5 4 6
1 2 3 4 5 6
</pre></div>
<p>这时，我们就有若干排 $1$ 到 $n$ 的排列，上例中有 $7$ 排。现在 scx 想知道，对于所有可能的置换，有多少种可能的排数。</p>

<h3>输入格式</h3>
<p>输入共一行，包含一个整数 $n$ ($1 \leq n \leq 1000$)。</p>

<h3>输出格式</h3>
<p>输出一行一个整数，表示可能的排数的个数。</p>

<h3>题解</h3>
<p>根据置换的性质，<strong>一个置换一定可以表示成若干个循环的乘积</strong>，设某置换 $f = (a_{11} a_{12} \cdots a_{1x_1}) (a_{21} a_{22} \cdot a_{2x_2}) (a_{y1} a_{y2} \cdot a_{yx_y})$，则在第 $i$ 个循环中，需要写 $x_i$ 排才能回到原来的顺序，故总的周期为每个循环的周期的 <abbr title="Least Common Multiple, 最小公倍数">LCM</abbr>，即 $T = \left[ x_1, x_2, \cdots, x_y \right]$。</p>
<p>那么，一种置换，就能映射到 $n$ 的一个拆分 $n = x_1 + x_2 + \cdots + x_y$，它的周期为 $T = \left[ x_1, x_2, \cdots, x_y \right]$，求这样的 $T$ 的个数。</p>
<p>记 $x_i$ 的分解式 (指数可为 $0$) 为 $x_i = p_1^{\alpha_{i1}} p_2^{\alpha_{i2}} \cdots p_l^{\alpha_{il}}$，则有 $$ T = \prod_{j=1}^l p_j^{\max\limits_{1 \leq i \leq y} \alpha_{ij}} $$</p>
<p>记 $\beta_j = \max\limits_{1 \leq i \leq y} \alpha_{ij}$，则有 $T = \prod\limits_{j=1}^l p_j^{\beta_j}$，且 $\sum\limits_{j=1}^l p_j^{\beta_j} \leq \sum\limits_{i=1}^y x_i = n$，而且对任一 $\sum p_j^{\beta_j} \leq n$，$T = \prod p_j^{\beta_j}$ 一定能取到 (容易构造)，因此我们只需要求 $\sum\limits_{j=1}^l p_j^{\beta_j} \leq n$ 的拆分个数。</p>
<p>做个差分，就是要求 $\sum\limits_{j=1}^l p_j^{\beta_j} = n$ 的拆分的个数，显然是一道经典背包 DP。</p>
<p>首先线性筛出 $1000$ 以内的素数 (打表也可以)，然后记 $f_{i, j}$ 表示用了前 $i$ 个素数后 $j$ 有多少种表示，则有边界 $f_{0, 0} = 1$ 和转移</p>
<p>$$ f_{i, j} = f_{i-1, j} + \sum_k f_{i-1, j-p_i^k} $$</p>
<p>其中 $p_i$ 是第 $i$ 个素数。那么答案就是 $\sum\limits_{j=0}^n f_{Z, j}$，其中 $Z$ 是素数个数。</p>

<h3>代码</h3>

<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_cpp"><span class="sh_preproc">#include</span> <span class="sh_string">&lt;bits/stdc++.h&gt;</span>
<span class="sh_preproc">#define</span> N <span class="sh_number">1034</span>
<span class="sh_preproc">#define</span> Z <span class="sh_number">169</span>
<span class="sh_keyword">using</span> <span class="sh_keyword">namespace</span> std<span class="sh_symbol">;</span>

<span class="sh_keyword">typedef</span> <span class="sh_type">long</span> <span class="sh_type">long</span> ll<span class="sh_symbol">;</span>

<span class="sh_type">const</span> <span class="sh_type">int</span> p<span class="sh_symbol">[</span>Z<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_cbracket">{</span><span class="sh_number">0</span><span class="sh_symbol">,</span> <span class="sh_number">2</span><span class="sh_symbol">,</span> <span class="sh_number">3</span><span class="sh_symbol">,</span> <span class="sh_number">5</span><span class="sh_symbol">,</span> <span class="sh_number">7</span><span class="sh_symbol">,</span> <span class="sh_number">11</span><span class="sh_symbol">,</span> <span class="sh_number">13</span><span class="sh_symbol">,</span> <span class="sh_number">17</span><span class="sh_symbol">,</span> <span class="sh_number">19</span><span class="sh_symbol">,</span> <span class="sh_number">23</span><span class="sh_symbol">,</span> <span class="sh_number">29</span><span class="sh_symbol">,</span> <span class="sh_number">31</span><span class="sh_symbol">,</span> <span class="sh_number">37</span><span class="sh_symbol">,</span> <span class="sh_number">41</span><span class="sh_symbol">,</span> <span class="sh_number">43</span><span class="sh_symbol">,</span> <span class="sh_number">47</span><span class="sh_symbol">,</span> <span class="sh_number">53</span><span class="sh_symbol">,</span> <span class="sh_number">59</span><span class="sh_symbol">,</span> <span class="sh_number">61</span><span class="sh_symbol">,</span> <span class="sh_number">67</span><span class="sh_symbol">,</span>
<span class="sh_number">71</span><span class="sh_symbol">,</span> <span class="sh_number">73</span><span class="sh_symbol">,</span> <span class="sh_number">79</span><span class="sh_symbol">,</span> <span class="sh_number">83</span><span class="sh_symbol">,</span> <span class="sh_number">89</span><span class="sh_symbol">,</span> <span class="sh_number">97</span><span class="sh_symbol">,</span> <span class="sh_number">101</span><span class="sh_symbol">,</span> <span class="sh_number">103</span><span class="sh_symbol">,</span> <span class="sh_number">107</span><span class="sh_symbol">,</span> <span class="sh_number">109</span><span class="sh_symbol">,</span> <span class="sh_number">113</span><span class="sh_symbol">,</span> <span class="sh_number">127</span><span class="sh_symbol">,</span> <span class="sh_number">131</span><span class="sh_symbol">,</span> <span class="sh_number">137</span><span class="sh_symbol">,</span> <span class="sh_number">139</span><span class="sh_symbol">,</span> <span class="sh_number">149</span><span class="sh_symbol">,</span> <span class="sh_number">151</span><span class="sh_symbol">,</span> <span class="sh_number">157</span><span class="sh_symbol">,</span> <span class="sh_number">163</span><span class="sh_symbol">,</span> <span class="sh_number">167</span><span class="sh_symbol">,</span>
<span class="sh_number">173</span><span class="sh_symbol">,</span> <span class="sh_number">179</span><span class="sh_symbol">,</span> <span class="sh_number">181</span><span class="sh_symbol">,</span> <span class="sh_number">191</span><span class="sh_symbol">,</span> <span class="sh_number">193</span><span class="sh_symbol">,</span> <span class="sh_number">197</span><span class="sh_symbol">,</span> <span class="sh_number">199</span><span class="sh_symbol">,</span> <span class="sh_number">211</span><span class="sh_symbol">,</span> <span class="sh_number">223</span><span class="sh_symbol">,</span> <span class="sh_number">227</span><span class="sh_symbol">,</span> <span class="sh_number">229</span><span class="sh_symbol">,</span> <span class="sh_number">233</span><span class="sh_symbol">,</span> <span class="sh_number">239</span><span class="sh_symbol">,</span> <span class="sh_number">241</span><span class="sh_symbol">,</span> <span class="sh_number">251</span><span class="sh_symbol">,</span> <span class="sh_number">257</span><span class="sh_symbol">,</span> <span class="sh_number">263</span><span class="sh_symbol">,</span> <span class="sh_number">269</span><span class="sh_symbol">,</span> <span class="sh_number">271</span><span class="sh_symbol">,</span> <span class="sh_number">277</span><span class="sh_symbol">,</span>
<span class="sh_number">281</span><span class="sh_symbol">,</span> <span class="sh_number">283</span><span class="sh_symbol">,</span> <span class="sh_number">293</span><span class="sh_symbol">,</span> <span class="sh_number">307</span><span class="sh_symbol">,</span> <span class="sh_number">311</span><span class="sh_symbol">,</span> <span class="sh_number">313</span><span class="sh_symbol">,</span> <span class="sh_number">317</span><span class="sh_symbol">,</span> <span class="sh_number">331</span><span class="sh_symbol">,</span> <span class="sh_number">337</span><span class="sh_symbol">,</span> <span class="sh_number">347</span><span class="sh_symbol">,</span> <span class="sh_number">349</span><span class="sh_symbol">,</span> <span class="sh_number">353</span><span class="sh_symbol">,</span> <span class="sh_number">359</span><span class="sh_symbol">,</span> <span class="sh_number">367</span><span class="sh_symbol">,</span> <span class="sh_number">373</span><span class="sh_symbol">,</span> <span class="sh_number">379</span><span class="sh_symbol">,</span> <span class="sh_number">383</span><span class="sh_symbol">,</span> <span class="sh_number">389</span><span class="sh_symbol">,</span> <span class="sh_number">397</span><span class="sh_symbol">,</span> <span class="sh_number">401</span><span class="sh_symbol">,</span>
<span class="sh_number">409</span><span class="sh_symbol">,</span> <span class="sh_number">419</span><span class="sh_symbol">,</span> <span class="sh_number">421</span><span class="sh_symbol">,</span> <span class="sh_number">431</span><span class="sh_symbol">,</span> <span class="sh_number">433</span><span class="sh_symbol">,</span> <span class="sh_number">439</span><span class="sh_symbol">,</span> <span class="sh_number">443</span><span class="sh_symbol">,</span> <span class="sh_number">449</span><span class="sh_symbol">,</span> <span class="sh_number">457</span><span class="sh_symbol">,</span> <span class="sh_number">461</span><span class="sh_symbol">,</span> <span class="sh_number">463</span><span class="sh_symbol">,</span> <span class="sh_number">467</span><span class="sh_symbol">,</span> <span class="sh_number">479</span><span class="sh_symbol">,</span> <span class="sh_number">487</span><span class="sh_symbol">,</span> <span class="sh_number">491</span><span class="sh_symbol">,</span> <span class="sh_number">499</span><span class="sh_symbol">,</span> <span class="sh_number">503</span><span class="sh_symbol">,</span> <span class="sh_number">509</span><span class="sh_symbol">,</span> <span class="sh_number">521</span><span class="sh_symbol">,</span> <span class="sh_number">523</span><span class="sh_symbol">,</span>
<span class="sh_number">541</span><span class="sh_symbol">,</span> <span class="sh_number">547</span><span class="sh_symbol">,</span> <span class="sh_number">557</span><span class="sh_symbol">,</span> <span class="sh_number">563</span><span class="sh_symbol">,</span> <span class="sh_number">569</span><span class="sh_symbol">,</span> <span class="sh_number">571</span><span class="sh_symbol">,</span> <span class="sh_number">577</span><span class="sh_symbol">,</span> <span class="sh_number">587</span><span class="sh_symbol">,</span> <span class="sh_number">593</span><span class="sh_symbol">,</span> <span class="sh_number">599</span><span class="sh_symbol">,</span> <span class="sh_number">601</span><span class="sh_symbol">,</span> <span class="sh_number">607</span><span class="sh_symbol">,</span> <span class="sh_number">613</span><span class="sh_symbol">,</span> <span class="sh_number">617</span><span class="sh_symbol">,</span> <span class="sh_number">619</span><span class="sh_symbol">,</span> <span class="sh_number">631</span><span class="sh_symbol">,</span> <span class="sh_number">641</span><span class="sh_symbol">,</span> <span class="sh_number">643</span><span class="sh_symbol">,</span> <span class="sh_number">647</span><span class="sh_symbol">,</span> <span class="sh_number">653</span><span class="sh_symbol">,</span>
<span class="sh_number">659</span><span class="sh_symbol">,</span> <span class="sh_number">661</span><span class="sh_symbol">,</span> <span class="sh_number">673</span><span class="sh_symbol">,</span> <span class="sh_number">677</span><span class="sh_symbol">,</span> <span class="sh_number">683</span><span class="sh_symbol">,</span> <span class="sh_number">691</span><span class="sh_symbol">,</span> <span class="sh_number">701</span><span class="sh_symbol">,</span> <span class="sh_number">709</span><span class="sh_symbol">,</span> <span class="sh_number">719</span><span class="sh_symbol">,</span> <span class="sh_number">727</span><span class="sh_symbol">,</span> <span class="sh_number">733</span><span class="sh_symbol">,</span> <span class="sh_number">739</span><span class="sh_symbol">,</span> <span class="sh_number">743</span><span class="sh_symbol">,</span> <span class="sh_number">751</span><span class="sh_symbol">,</span> <span class="sh_number">757</span><span class="sh_symbol">,</span> <span class="sh_number">761</span><span class="sh_symbol">,</span> <span class="sh_number">769</span><span class="sh_symbol">,</span> <span class="sh_number">773</span><span class="sh_symbol">,</span> <span class="sh_number">787</span><span class="sh_symbol">,</span> <span class="sh_number">797</span><span class="sh_symbol">,</span>
<span class="sh_number">809</span><span class="sh_symbol">,</span> <span class="sh_number">811</span><span class="sh_symbol">,</span> <span class="sh_number">821</span><span class="sh_symbol">,</span> <span class="sh_number">823</span><span class="sh_symbol">,</span> <span class="sh_number">827</span><span class="sh_symbol">,</span> <span class="sh_number">829</span><span class="sh_symbol">,</span> <span class="sh_number">839</span><span class="sh_symbol">,</span> <span class="sh_number">853</span><span class="sh_symbol">,</span> <span class="sh_number">857</span><span class="sh_symbol">,</span> <span class="sh_number">859</span><span class="sh_symbol">,</span> <span class="sh_number">863</span><span class="sh_symbol">,</span> <span class="sh_number">877</span><span class="sh_symbol">,</span> <span class="sh_number">881</span><span class="sh_symbol">,</span> <span class="sh_number">883</span><span class="sh_symbol">,</span> <span class="sh_number">887</span><span class="sh_symbol">,</span> <span class="sh_number">907</span><span class="sh_symbol">,</span> <span class="sh_number">911</span><span class="sh_symbol">,</span> <span class="sh_number">919</span><span class="sh_symbol">,</span> <span class="sh_number">929</span><span class="sh_symbol">,</span> <span class="sh_number">937</span><span class="sh_symbol">,</span>
<span class="sh_number">941</span><span class="sh_symbol">,</span> <span class="sh_number">947</span><span class="sh_symbol">,</span> <span class="sh_number">953</span><span class="sh_symbol">,</span> <span class="sh_number">967</span><span class="sh_symbol">,</span> <span class="sh_number">971</span><span class="sh_symbol">,</span> <span class="sh_number">977</span><span class="sh_symbol">,</span> <span class="sh_number">983</span><span class="sh_symbol">,</span> <span class="sh_number">991</span><span class="sh_symbol">,</span> <span class="sh_number">997</span><span class="sh_cbracket">}</span><span class="sh_symbol">;</span>

<span class="sh_type">int</span> n<span class="sh_symbol">,</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> k<span class="sh_symbol">;</span>
<span class="sh_usertype">ll</span><span class="sh_normal"> </span>f<span class="sh_symbol">[</span>Z<span class="sh_symbol">][</span>N<span class="sh_symbol">],</span> ans <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>

<span class="sh_type">int</span> <span class="sh_function">main</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d"</span><span class="sh_symbol">,</span> <span class="sh_symbol">&amp;</span>n<span class="sh_symbol">);</span>
    f<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> Z<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
            f<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">];</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>k <span class="sh_symbol">=</span> p<span class="sh_symbol">[</span>i<span class="sh_symbol">];</span> k <span class="sh_symbol">&lt;=</span> j<span class="sh_symbol">;</span> k <span class="sh_symbol">*=</span> p<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span> f<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">+=</span> f<span class="sh_symbol">[</span>i <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j <span class="sh_symbol">-</span> k<span class="sh_symbol">];</span>
        <span class="sh_cbracket">}</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;=</span> n<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span> ans <span class="sh_symbol">+=</span> f<span class="sh_symbol">[</span>Z <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">][</span>j<span class="sh_symbol">];</span>
    <span class="sh_function">printf</span><span class="sh_symbol">(</span><span class="sh_string">"%lld</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> ans<span class="sh_symbol">);</span>
    <span class="sh_keyword">return</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

</code></pre></div>

<h3>坑</h3>
<p><strong>坑1：</strong>最后不要忘了前缀和，写筛法的注意不要写挂。<del>听说不差分直接 DP 也可以？</del></p>

