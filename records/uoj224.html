<!DOCTYPE html>
<link type="text/css" rel="stylesheet" href="../additional_files/css/bootstrap.min.css">
<link type="text/css" rel="stylesheet" href="../additional_files/css/sh_typical.min.css">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$', '$']], displayMath: [['$$', '$$']]}});</script>
<script type="text/javascript" src="../additional_files/MathJax-master/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<style type="text/css">
.table p {margin-bottom: 0px}
.fuchsia-text {color: #F0F}
.blue-text {color: blue}
</style>

<h3>题目描述</h3>
<p>随着人类计算机技术的发展，计算机的能力不断提升，让跳蚤国王非常羡慕。</p>
<p>终于有一天，跳蚤国王发布政令：大力发展跳蚤国的计算机产业！然而，跳蚤国尚未进行工业革命，无法制造出电子计算机所需的元器件。但是跳蚤国王想出了一个绝妙的想法：把每只跳蚤作为一个计算节点，每只跳蚤只完成一个特定的小任务。</p>
<p>跳蚤国王带领 $n$ 只跳蚤来到了一片旷野上，把跳蚤作为计算节点在旷野上排列好，并编号为 $1$ 到 $n$。每个计算节点会把某几个 (也有可能是 $0$ 个) 计算节点的结果作为输入，计算得到输出。除此之外，跳蚤国王还有一个巨型的终端，可以从终端输入和输出数据，这台终端和所有计算节点组成了一台计算机。</p>
<p>记第 $t$ 个计算节点的输出为 $x_t$，该节点的操作可分为以下几种类型：</p>

<table class="table table-bordered table-text-center table-vertical-middle">
	<thead>
		<tr>
			<th>名称</th>
			<th>操作符（类型）</th>
			<th>操作数</th>
			<th>计算结果</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>输入节点</td>
			<td><code>I</code></td>
			<td>无</td>
			<td>从终端读入一个实数作为 $x_t$</td>
		</tr>
		<tr>
			<td>输出节点</td>
			<td><code>O</code></td>
			<td>$i$</td>
			<td>$x_t = x_i$，并将 $x_t$ 输出到终端</td>
		</tr>
		<tr>
			<td>加法节点</td>
			<td><code>+</code></td>
			<td>$i, j$</td>
			<td>$x_t = x_i + x_j$</td>
		</tr>
		<tr>
			<td>偏移节点</td>
			<td><code>C</code></td>
			<td>$i, c$</td>
			<td>$x_t = x_i + c$</td>
		</tr>
		<tr>
			<td>取反节点</td>
			<td><code>-</code></td>
			<td>$i$</td>
			<td>$x_t = -x_i$</td>
		</tr>
		<tr>
			<td>左移节点</td>
			<td><code>&lt;</code></td>
			<td>$i, k$</td>
			<td>$x_t = x_i \cdot 2^k$</td>
		</tr>
		<tr>
			<td>右移节点</td>
			<td><code>&gt;</code></td>
			<td>$i, k$</td>
			<td>$x_t = x_i / 2^k$</td>
		</tr>
		<tr>
			<td>S 型节点</td>
			<td><code>S</code></td>
			<td>$i$</td>
			<td>$x_t = s(x_i)$</td>
		</tr>
		<tr>
			<td>比较节点</td>
			<td><code>P</code></td>
			<td>$i, j$</td>
			<td>$$ x_t = \begin{cases}-1 &amp; x_i \lt x_j \\ 0 &amp; x_i = x_j \\ 1 &amp; x_i \gt x_j \end{cases} $$</td>
		</tr>
		<tr>
			<td>Max 节点</td>
			<td><code>M</code></td>
			<td>$i, j$</td>
			<td>$$ x_t = \begin{cases}x_i &amp; x_i \gt x_j \\ x_j &amp; x_i \le x_j \end{cases} $$</td>
		</tr>
		<tr>
			<td>乘法节点</td>
			<td><code>*</code></td>
			<td>$i, j$</td>
			<td>$x_t = x_i \cdot x_j$</td>
		</tr>
	</tbody>
</table>

<p>其中，$s(x)$ 的定义如下：($e$ 为自然常数，其值约为 $2.718281828459045\cdots$)</p>
<p>$$ s(x) = \frac 1 {1 + e^{-x}} $$</p>
<p>$s(x)$ 的函数图像如下图所示：</p>
<img class="center-block" src="http://img.uoj.ac/problem/224/w.png" />
<p>上述表格中的操作数 $i, j$ 均要小于当前节点的编号 $t$，这样随着跳蚤国王的一声令下，跳蚤就可以按编号从小到大的顺序，依次获得输入然后计算输出。每个跳蚤的计算能力都是有限的，他们仅可以精确到十进制小数点后 $90$ 位，超过的部分将会被四舍五入。同理，上述表格中的操作数 $c$ 的小数部分也不能超过 $90$ 位。另外，左移节点和右移节点中的操作数 $k$ 必须是非负整数，且不能超过 $10^4$。</p>
<p>把跳蚤排列好后，野心勃勃的跳蚤国王决心测试一下这台由跳蚤组成的计算机的计算能力，于是蝈蝈大臣给跳蚤国王献上了 $10$ 个计算任务。完成每个计算任务均需要从终端获取输入，进行中间计算，再用输出节点将结果输出。具体任务说明如下：</p>

<script type="math/tex">\DeclareMathOperator{\sgn}{\mathrm{sgn}}
\DeclareMathOperator{\sig}{\mathrm{sig}}
\DeclareMathOperator{\iif}{\mathrm{iif}}
</script>
<table class="table table-bordered table-text-center table-vertical-middle">
	<thead>
		<tr>
			<th>编号</th>
			<th>输入</th>
			<th>输入限制</th>
			<th>输出</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>1</td>
			<td>$a, b$</td>
			<td><p>$\lvert a \rvert, \lvert b \rvert \leq 10^9$</p><p>小数部分不超过 $9$ 位</p></td>
			<td>$-2a-2b$</td>
		</tr>
		<tr>
			<td>2</td>
			<td>$a$</td>
			<td><p>$\lvert a \rvert \leq 10^9$</p><p>小数部分不超过 $9$ 位</p></td>
			<td>$\dfrac 1 {1 + e^{17a}}$</td>
		</tr>
		<tr>
			<td>3</td>
			<td>$a$</td>
			<td><p>$\lvert a \rvert \leq 10^9$</p><p>小数部分不超过 $9$ 位</p></td>
			<td>$\sgn a$</td>
		</tr>
		<tr>
			<td>4</td>
			<td>$a$</td>
			<td><p>$\lvert a \rvert \leq 10^9$</p><p>小数部分不超过 $9$ 位</p></td>
			<td>$\lvert a \rvert$</td>
		</tr>
		<tr>
			<td>5</td>
			<td>$a_1, \cdots, a_{32}$</td>
			<td>$a_1, \cdots, a_{32} \in \{0, 1\}$</td>
			<td>把 $a_1, \cdots, a_{32}$ 从左到右看成一个二进制整数，高位在左低位在右，输出该整数的值</td>
		</tr>
		<tr>
			<td>6</td>
			<td>$a$</td>
			<td><p>$0 \leq a &lt; 2^{32}$</p><p>$a$ 为整数</p></td>
			<td>输出 $32$ 个整数，从高位到低位输出 $a$ 的二进制表示 (不足 $32$ 位的在高位补 $0$)</td>
		</tr>
		<tr>
			<td>7</td>
			<td>$a,b$</td>
			<td><p>$0 \leq a, b &lt; 2^{32}$</p><p>$a, b$ 均为整数</p></td>
			<td>$a, b$ 按位异或的结果</td>
		</tr>
		<tr>
			<td>8</td>
			<td>$a$</td>
			<td><p>$\lvert a \rvert \leq 10^9$</p><p>小数部分不超过 $9$ 位</p></td>
			<td>$\dfrac a {10}$</td>
		</tr>
		<tr>
			<td>9</td>
			<td>$a_1, \cdots, a_{16}$</td>
			<td><p>$\lvert a_1 \rvert, \cdots, \lvert a_{16} \rvert \leq 10^9$</p><p>小数部分不超过 $9$ 位</p></td>
			<td>输出 $16$ 个实数，表示 $a_1, \cdots, a_{16}$ 从小到大排序后的结果</td>
		</tr>
		<tr>
			<td>10</td>
			<td>$a, b, m$</td>
			<td><p>$0 \leq a, b &lt; 2^{32}, 1 \leq m &lt; 2^{32}$</p><p>$a, b, m$ 均为整数</p></td>
			<td>$a \cdot b$ 除以 $m$ 的余数</td>
		</tr>
	</tbody>
</table>

<p>跳蚤国王发现自己没有足够的能力设计这样的计算机。于是他找到了来参加 NOI 的你。请你依次设计每个计算节点的类型及操作数，完成蝈蝈大臣给的这 $10$ 个计算任务，且要求使用的计算节点数尽量少。</p>

<h3>输入格式</h3>
<p>输入仅包含一个整数，表示需要解决的计算任务编号。</p>

<h3>输出格式</h3>
<p>对于每组输入数据，你需要依次输出若干行，第 $i$ 行描述第 $i$ 个计算节点。</p>
<p>描述每个计算节点时，首先一个字符表示该计算节点的类型，接下来若干个数按顺序表示该计算节点的内置参数。字符与数，数与数之间均用空格隔开。</p>
<p>输出的行数不能超过 $10^4$ 行。</p>

<h3>题解</h3>
<p><del>游戏</del>规则应该都熟悉了吧……</p>
<p>为了避免节点编号计算查找的复杂性，其实就可以写一个拟类来自动计算 + 存储节点编号，具体实现见代码。</p>
<p>先来看<span class="fuchsia-text">第 $1$ 个子任务</span>：Hmm......斯波题，<code>-(a + b &lt;&lt; 1)</code> 完事，<span class="blue-text">共 $6$ 个操作。</span></p>
<p>再来看<span class="fuchsia-text">第 $2$ 个子任务</span>：还是非常滴显然，直接 <code>sig(-(a + (a &lt;&lt; 4)))</code> 就可以了，$\sig(x)$ 为 sigmoid 函数 $s(x)$，<strong>注意不要忘记取负</strong>，<span class="blue-text">共 $6$ 个操作。</span></p>
<p>然后是<span class="fuchsia-text">第 $5$ 个子任务</span>：Hmm......暴力就可以了，做 31 次 <code>num = (num &lt;&lt; 1) + arr[i]</code> 即可，<span class="blue-text">共 $95$ 个操作。</span></p>
<p>考虑<span class="fuchsia-text">第 $3$ 个子任务</span>：符号函数？看起来用个 <code>P</code> 就可以了，不过扣分的 <code>P</code>, <code>M</code> 和 <code>*</code> 是不能使用的，那么只有以下运算符：<code>+</code>(<code>C</code>), <code>-</code>, <code>&lt;</code> , <code>&gt;</code>，还有一个玄学的 sigmoid 函数 <code>S</code>。</p>
<p>显然不用 sigmoid 函数是做不到的，那么只能用这个<del>破</del>玩意儿了，考虑符号函数 $\sgn x$ 的图像：</p>
<img class="center-block" src="https://upload.wikimedia.org/wikipedia/commons/4/4f/Signum_function.svg" />
<p>然后这个是 sigmoid 函数：</p>
<img class="center-block" src="http://img.uoj.ac/problem/224/w.png" />
<p>如果你脑洞比较大的话，应该可以发现，<del>如果不看坐标轴的话，符号函数和 $\sgn x$ 的图像有点像……</del></p>
<p>事实上，当 $x \to +\infty$ ($x \to -\infty$) 时，就有 $\sig x \to 1$ ($\sig x \to 0$)，又 $\sig 0 = \dfrac 12$，也就是说，当 $|x| = 0$ 或 $x \to \infty$ 时，有 $\sgn x = 2\sig x - 1$，所以，只需利用<strong>左移</strong>操作，使 $x$ 的绝对值<strong>乘上</strong>一个<strong>充分大</strong>的值，然后调用 $\sig x$，再做平移变换就可以了，<span class="blue-text">共 $6$ 个操作。</span></p>
<p><span class="fuchsia-text">第 $4$ 个子任务</span>：绝对值？根据公式，$|x| = x \cdot \sgn x$，所以需要乘法 (然后你发现还没实现乘法？)，还有公式，$|x| = \max \{x, -x\}$，或者需要 $\max$ (然后你发现还没实现 $\max$？)，好慌啊……</p>
<p>考虑到 $\sgn x$ 是个<strong>三值函数</strong>，而 $a$ 的小数部分又不超过 $9$ 位，因此，我们可以将 $a$ 加上一个 eps，比如 <code>1e-34</code> ($10^{-34}$)，再调用<strong>左移 + sigmoid 函数</strong>，就得到了一个<strong>双值函数——非负函数</strong>，利用 <a href="../index.html?redirect=47#iverson" target="_blank">Iverson 约定</a>就记作 $[x \geq 0]$，说过了，它可以利用<strong>左移 + sigmoid 函数</strong> 实现。</p>
<p>换个公式，就有 $|x| = x - [x &lt; 0](2x)$，因此下面就是重头戏：<strong>实现 iif 函数</strong> (说白了就是一个参数为 1 或 0 的乘法)，通常直接用 Iverson 约定表示，如 $[x &lt; 0](2x)$，因为 $\neg \, x$ 就是直接用 $1$ 减。</p>
<p>我们将要实现的 iif 函数具有如下行为：$\iif (c, x) = -[c = 0]x$，其中 $c \in \{-1, 0, 1\}$。</p>
<p>记 $N$ 是一个<strong>充分大</strong>的正数，令 $p = 2N \cdot c$，考虑 $y = \dfrac 12 - \sig(\dfrac x N + p)$，显然，如果 $c \neq 0$，则 $y = -\dfrac 12 \sgn c = -\dfrac 12 c$ (因为 $|c| = 1$)，则 $4N \cdot y + p = -2N \cdot c + 2N \cdot c = 0$。</p>
<p>然而这里的 $y$ 带有 sigmoid 函数，而当 $c = 0$ 时要返回有关 $x$ 的信息 ($-x$)，因此考虑 sigmoid 函数的性质。</p>
<p>考虑到这是一个连续函数，因此它可以求导，将它求导即</p>
<p>$$ \sig'x = \left( \frac 1 {1 + e^{-x}} \right)' = \frac {(-1) \cdot (-e^{-x})} {\left( 1 + e^{-x} \right)^2} = \frac {e^{-x}} {\left( 1 + e^{-x} \right)^2}
= \left( \frac 1 {1 + e^{-x}} \right) \cdot \left( \frac {e^{-x}} {1 + e^{-x}} \right) = \sig x \cdot \left( 1 - \sig x \right) $$</p>
<p>那么有 $\sig'0 = \sig 0 \cdot (1 - \sig 0) = \dfrac 12 \cdot \dfrac 12 = \dfrac 14$，即当 $x \to 0$ 时，$\dfrac {\sig x - \sig 0} x \to \dfrac 14$，因此有 $\sig x = \dfrac 12 + \dfrac 14 x + o(x^2)$ (当 $x \to 0$ 时)。</p>
<p>那么当 $c = 0$ 时，$p = 0$，故 $y = -\dfrac x {4N}$，故 $4N \cdot y + p = -x + 0 = -x$，满足要求，当然，$N$ 可以是一个 $2$ 的幂，然后利用左右移位操作实现。</p>
<p>于是绝对值 $|x| = x + \iif \left( [x \geq 0], 2x \right)$，不过并不能满分，需要稍微卡卡常数，比如说改成 $8N \cdot y + p$，然后 $p = 4N \cdot c$，不过原来这种标准的 iif 形式在后面也会遇到的，<span class="blue-text">操作个数可以达到 $14$。</span></p>
<p><span class="fuchsia-text">第 $6$ 个子任务</span>：十进制转二进制？不像第 $5$ 个点一样可以直接暴力做了，主要有两种思路：</p>
<ol>
<li>从低位往高位计算，每次对 $2$ 取模后右移一位。</li>
<li>从高位往低位计算，每次计算是否超过 $2^k$，然后对其取模。</li>
</ol>
<p>很快我们发现，这里取模的实现<strong>并不容易</strong>，因此考虑第 2 种思路，而判断是否超过，刚刚有了非负函数的工具，而且取模就是相减，直接左移即可。</p>
<p>由于 $a$ 是<strong>无符号 $32$ 位整数</strong>，所以我们需要计算 $32$ 次，拿第一次为例 (以下 $x$ 就是原题的 $a$)：</p>
<p>先计算 $y = [x \geq 2^{31}]$，即 $y = [(x - 2^{31}) \geq 0]$，然后令 $x \gets x - 2^{31} y$，重复做 $32$ 次即可。</p>
<p>然而这还是不能满分 (scx: ...)，我们需要<strong>继续卡常</strong>。考虑实现非负函数时，需要<strong>不断进行移位操作</strong>，那么，我们可以先让 $x$ 移足够多的位，然后这时 $[x \geq y] = \sig(x - y)$。</p>
<p>当然，只需要做 $31$ 次操作，因为最后一次是与 $1$ 比较，只要直接输出即可，<span class="blue-text">共 $190$ 个操作。</span></p>
<p><span class="fuchsia-text">第 $7$ 个子任务</span>：按位异或？只需要把 $a$ 和 $b$ 按照第 $6$ 个任务的方法转成二进制，然后分别异或后按照第 $5$ 个任务的方法转成十进制，因此我们只需要实现一个 1-bit 异或操作。</p>
<p>考虑 $a, b \in \{0, 1\}$，于是 $a \oplus b$ 只与 $x = a + b$ 有关，满足</p>
<p>$$ a \oplus b = \begin{cases} x &amp; x &lt; 2 \\ 0 &amp; x \geq 2 \end{cases} = x - 2[x \geq 2] $$</p>
<p>，利用非负函数，不解释，<span class="blue-text">操作个数不超过 $603$。</span></p>
<p><span class="fuchsia-text">第 $8$ 个子任务</span>：乘以 $\dfrac 1 {10}$？如果是乘以 $10$，那么就非常简单，直接 <code>(x &lt;&lt; 2) + x &lt;&lt; 1</code> 即可，因为 $10$ 在二进制下为 $(1010)_2$，具有有限位数，而 $\dfrac 1 {10}$ 在二进制下为 $0.0 \dot 001 \dot 1$，为循环小数。</p>
<p>那么可以拆成无穷多个移位和相加的和，即 <code>y = (x &gt;&gt; 3) + (x &gt;&gt; 4) + (x &gt;&gt; 7) + (x &gt;&gt; 8) + (x &gt;&gt; 11) + (x &gt;&gt; 12) + ...</code>，发现只有 $8$ 分，考虑倍增，那么就有如下思路：</p>
<pre>
y = (x &gt;&gt; 3) + (x &gt;&gt; 4);
y = y + (y &gt;&gt; 4);
y = y + (y &gt;&gt; 8);
y = y + (y &gt;&gt; 16);
y = y + (y &gt;&gt; 32)...
</pre>
<p>然而发现刚刚到精度时只有 $9$ 分……怎么办呢？</p>
<p>考虑在做第 $4$ 个任务时，我们用导数求得了当 $x \to 0$ 时有 $\sig x = \dfrac 12 + \dfrac 14 x + o(x^2)$，这样我们就<strong>在没有用移位操作 <code>&gt;</code> 的情况下</strong>得到了 $\dfrac 14 x$ 的值，如果我们找到了一个 $x_0$ 使得 $\sig'x_0 = \dfrac 1 {10}$，即当 $x \to x_0$ 时，$\dfrac {\sig x - \sig x_0} {x - x_0} \to \dfrac 1 {10}$，因此有 $\sig x = \sig x_0 + \dfrac 1 {10} (x - x_0) + o\left( (x - x_0)^2 \right)$ (当 $x \to x_0$ 时)，令 $\Delta x = x - x_0$，那么原公式即 $\sig (x_0 + \Delta x) - \sig x_0 = \dfrac 1 {10} \Delta x + o\left( (\Delta x)^2 \right)$ (当 $\Delta x \to 0$ 时)。</p>
<p>依旧设 $N$ 是一个<strong>充分大</strong>的正数，考虑 $y = N \left( \sig(x_0 + \dfrac x N) - \sig(x_0) \right)$，根据上面的公式，可以看出，$y = \dfrac 1 {10} x$，<span class="blue-text">只需 $7$ 个操作。</span></p>
<p><span class="fuchsia-text">第 $9$ 个子任务</span>：排序？由于这个计算网络不支持随机访问 (下标访问)，所以快速排序、堆排序等等是不适合的 (可能插入排序都要判到底)，因此推荐使用选择排序、冒泡排序等，<del>想要装逼的</del>当然也可以写写双调排序，具体代码在下面 (思想和蝴蝶优化 FFT 非常像)，只不过复杂度为 $\Theta(n \log^2 n)$。</p>
<p>其实这些排序<strong>都是基于交换的</strong>，因此我们最重点的功能就是<strong>实现让两个数有序</strong>的功能，即<strong>实现一个 <code>lt(&amp;x, &amp;y)</code> 函数，运行完毕后满足 $x \leq y$</strong>。</p>
<p>利用<strong>非负函数</strong>，我们可以得到 $d = [y \geq x]$，然后利用 <strong>iif 函数</strong>，又可以得到 $g = \iif(d, y - x) = [y &lt; x](x - y)$。</p>
<p>所以如果 $x &gt; y$，则 $g = x - y$，令 $y' = y + g = x$，再令 $x' = (x + y) - y' = y$。</p>
<p>如果 $x \leq y$，则 $g = 0$，那么 $y', x'$ 就是原来的 $y, x$，那么也没有问题。</p>
<p>于是，我们就实现了一个 <code>lt(&amp;x, &amp;y)</code> 函数，然后各种排序方法就可以大展身手了。<span class="blue-text">操作个数不超过 $2072$，如果使用了双调排序，则操作个数不超过 $1392$。</span></p>
<p><span class="fuchsia-text">第 $10$ 个子任务</span>：乘模函数？看起来有个叫做快速加的东西，不过操作个数比较多，可以用一些新方法，来玩玩我们的微积分能力。</p>
<p>考虑到如果我们能实现 $x^2$，那么根据公式，$xy = \dfrac {(x + y)^2 - (x^2 + y^2)} 2$，然后就是一个取模罢了。</p>
<p>考虑 sigmoid 函数，它是个 (拟) 奇函数，不利于平方，我们可以将它做一个 (左右) 平移变换，考虑 $\dfrac 1 {1 + 4e^{-x}}$，将它进行 Taylor 展开后得到</p>
<p>$$ \frac 1 {1 + 4e^{-x}} = \frac 15 + \frac 4 {25} x + \frac 6 {125} x^2 + \frac 2 {1875} x^3 + o(x^4) $$</p>
<p>(当 $x \to 0$ 时)，考虑 $\dfrac 1 {1 + \frac 14 e^{-x}}$，也进行 Taylor 展开后得到</p>
<p>$$ \frac 1 {1 + \frac 14 e^{-x}} = \frac 45 + \frac 4 {25} x - \frac 6 {125} x^2 + \frac 2 {1875} x^3 + o(x^4) $$</p>
<p>(当 $x \to 0$ 时)，两式相减就得到</p>
<p>$$ \frac 1 {1 + e^{-(x - \ln 4)}} - \frac 1 {1 + e^{-(x + \ln 4)}}
= \frac 1 {1 + 4e^{-x}} - \frac 1 {1 + \frac 14 e^{-x}} = -\frac 35 + \frac 12 {125} x^2 + o(x^4) $$</p>
<p>，再利用第 $8$ 个任务的方法乘以一个常数，就<del>轻松</del>实现了平方操作，从而实现了乘法操作 (应该发现到此我们已经实现了 $3$ 个扣分操作)。</p>
<p>取模这东西，<del>应该就更简单了</del>，应为商不超过 $2^{32}$ 次，所以利用倍增的思想，先判断商是否超过 $2^{31}$，判断要不要减……感觉和第 $6$ 个任务的方法很(ji)像，<span class="blue-text">操作个数不超过 $819$。</span></p>
<hr />
<p>至此，我们已经成功解决了所有 $10$ 个子任务，代码见下。</p>
<p>最后，如果你们还想测试微积分能力的话，这里还有一道<a href="https://www.luogu.org/problem/show?pid=U8207" target="_blank">类似的题目</a>，可以挑战一下哦！</p>

<h3>代码</h3>

<div class="panel-body"><pre class="sh_sourceCode"><code class="sh_cpp"><span class="sh_preproc">#include</span> <span class="sh_string">&lt;bits/stdc++.h&gt;</span>
<span class="sh_keyword">using</span> <span class="sh_keyword">namespace</span> std<span class="sh_symbol">;</span>

<span class="sh_type">int</span> t <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
<span class="sh_usertype">FILE</span><span class="sh_normal"> </span><span class="sh_symbol">*</span>fout<span class="sh_symbol">;</span>
<span class="sh_type">int</span> <span class="sh_function">clear</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span><span class="sh_function">fclose</span><span class="sh_symbol">(</span>fout<span class="sh_symbol">);</span> <span class="sh_keyword">return</span> t <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span><span class="sh_cbracket">}</span>
<span class="sh_keyword">struct</span><span class="sh_normal"> </span><span class="sh_classname">mint</span><span class="sh_cbracket">{</span>
    <span class="sh_type">int</span> no<span class="sh_symbol">;</span>
    <span class="sh_function">mint</span> <span class="sh_symbol">(</span><span class="sh_type">int</span> x <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">):</span> <span class="sh_function">no</span><span class="sh_symbol">(</span>x<span class="sh_symbol">)</span> <span class="sh_cbracket">{}</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">+</span> <span class="sh_symbol">(</span>mint _b<span class="sh_symbol">)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// node +</span>
        <span class="sh_function">fprintf</span><span class="sh_symbol">(</span>fout<span class="sh_symbol">,</span> <span class="sh_string">"+ %d %d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> no<span class="sh_symbol">,</span> _b<span class="sh_symbol">.</span>no<span class="sh_symbol">);</span>
        <span class="sh_keyword">return</span> <span class="sh_function">mint</span><span class="sh_symbol">(++</span>t<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">+</span> <span class="sh_symbol">(</span><span class="sh_keyword">const</span> <span class="sh_type">char</span> <span class="sh_symbol">*</span>s<span class="sh_symbol">)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// node C</span>
        <span class="sh_function">fprintf</span><span class="sh_symbol">(</span>fout<span class="sh_symbol">,</span> <span class="sh_string">"C %d %s</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> no<span class="sh_symbol">,</span> s<span class="sh_symbol">);</span>
        <span class="sh_keyword">return</span> <span class="sh_function">mint</span><span class="sh_symbol">(++</span>t<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">-</span> <span class="sh_symbol">()</span><span class="sh_cbracket">{</span> <span class="sh_comment">// node -</span>
        <span class="sh_function">fprintf</span><span class="sh_symbol">(</span>fout<span class="sh_symbol">,</span> <span class="sh_string">"- %d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> no<span class="sh_symbol">);</span>
        <span class="sh_keyword">return</span> <span class="sh_function">mint</span><span class="sh_symbol">(++</span>t<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_keyword">friend</span> <span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>mint _a<span class="sh_symbol">,</span> mint _b<span class="sh_symbol">);</span> <span class="sh_comment">// multiplication </span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">&lt;&lt;</span> <span class="sh_symbol">(</span><span class="sh_type">int</span> deg<span class="sh_symbol">)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// node &lt;</span>
        <span class="sh_function">fprintf</span><span class="sh_symbol">(</span>fout<span class="sh_symbol">,</span> <span class="sh_string">"&lt; %d %d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> no<span class="sh_symbol">,</span> deg<span class="sh_symbol">);</span>
        <span class="sh_keyword">return</span> <span class="sh_function">mint</span><span class="sh_symbol">(++</span>t<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">&gt;&gt;</span> <span class="sh_symbol">(</span><span class="sh_type">int</span> deg<span class="sh_symbol">)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// node &gt;</span>
        <span class="sh_function">fprintf</span><span class="sh_symbol">(</span>fout<span class="sh_symbol">,</span> <span class="sh_string">"&gt; %d %d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> no<span class="sh_symbol">,</span> deg<span class="sh_symbol">);</span>
        <span class="sh_keyword">return</span> <span class="sh_function">mint</span><span class="sh_symbol">(++</span>t<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">&gt;=</span> <span class="sh_symbol">(</span><span class="sh_type">int</span> z<span class="sh_symbol">);</span> <span class="sh_comment">// greater or equal to 0</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_function">out</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span> <span class="sh_comment">// node O</span>
        <span class="sh_function">fprintf</span><span class="sh_symbol">(</span>fout<span class="sh_symbol">,</span> <span class="sh_string">"O %d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> no<span class="sh_symbol">);</span>
        <span class="sh_keyword">return</span> <span class="sh_function">mint</span><span class="sh_symbol">(++</span>t<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
<span class="sh_cbracket">}</span><span class="sh_symbol">;</span>
<span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_function">in</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span> <span class="sh_comment">// node I</span>
    <span class="sh_function">fputs</span><span class="sh_symbol">(</span><span class="sh_string">"I</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> fout<span class="sh_symbol">);</span>
    <span class="sh_keyword">return</span> <span class="sh_function">mint</span><span class="sh_symbol">(++</span>t<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>
<span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_function">sig</span><span class="sh_symbol">(</span>mint _b<span class="sh_symbol">)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// node S</span>
    <span class="sh_function">fprintf</span><span class="sh_symbol">(</span>fout<span class="sh_symbol">,</span> <span class="sh_string">"S %d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span> _b<span class="sh_symbol">.</span>no<span class="sh_symbol">);</span>
    <span class="sh_keyword">return</span> <span class="sh_function">mint</span><span class="sh_symbol">(++</span>t<span class="sh_symbol">);</span>
<span class="sh_cbracket">}</span>
<span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_function">sgn</span><span class="sh_symbol">(</span>mint _b<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span><span class="sh_keyword">return</span> <span class="sh_function">sig</span><span class="sh_symbol">(</span>_b <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">2333</span><span class="sh_symbol">);</span><span class="sh_cbracket">}</span> <span class="sh_comment">// sign function</span>
<span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_function">combine</span><span class="sh_symbol">(</span><span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_symbol">*</span>arr<span class="sh_symbol">)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// base 2 combine to base 10</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>num <span class="sh_symbol">=</span> arr<span class="sh_symbol">[</span><span class="sh_number">31</span><span class="sh_symbol">];</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> i <span class="sh_symbol">=</span> <span class="sh_number">30</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i<span class="sh_symbol">--)</span>
        num <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>num <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> arr<span class="sh_symbol">[</span>i<span class="sh_symbol">];</span>
    <span class="sh_keyword">return</span> num<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>
<span class="sh_type">void</span> <span class="sh_function">apart</span><span class="sh_symbol">(</span><span class="sh_usertype">mint</span><span class="sh_normal"> </span>num<span class="sh_symbol">,</span> <span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_symbol">*</span>arr<span class="sh_symbol">)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// base 10 apart to base 2</span>
    num <span class="sh_symbol">=</span> num <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">500</span><span class="sh_symbol">;</span>
    <span class="sh_type">long</span> <span class="sh_type">long</span> t <span class="sh_symbol">=</span> 702955280397374434ll<span class="sh_symbol">;</span>
    <span class="sh_type">char</span> buf<span class="sh_symbol">[</span><span class="sh_number">180</span><span class="sh_symbol">],</span> zero<span class="sh_symbol">[</span><span class="sh_number">143</span><span class="sh_symbol">];</span>
    <span class="sh_function">memset</span><span class="sh_symbol">(</span>zero<span class="sh_symbol">,</span> <span class="sh_number">48</span><span class="sh_symbol">,</span> <span class="sh_keyword">sizeof</span> zero<span class="sh_symbol">);</span>
    zero<span class="sh_symbol">[</span><span class="sh_number">142</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_string">'</span><span class="sh_specialchar">\0</span><span class="sh_string">'</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> i <span class="sh_symbol">=</span> <span class="sh_number">31</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&gt;=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i<span class="sh_symbol">--)</span><span class="sh_cbracket">{</span>
        <span class="sh_function">sprintf</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">,</span> <span class="sh_string">"-%lld"</span><span class="sh_symbol">,</span> t<span class="sh_symbol">);</span>
        <span class="sh_function">strcat</span><span class="sh_symbol">(</span>buf<span class="sh_symbol">,</span> zero<span class="sh_symbol">);</span>
        arr<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">sig</span><span class="sh_symbol">(</span>num <span class="sh_symbol">+</span> buf<span class="sh_symbol">);</span>
        num <span class="sh_symbol">=</span> num <span class="sh_symbol">+</span> <span class="sh_symbol">-(</span>arr<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">&lt;&lt;</span> i <span class="sh_symbol">+</span> <span class="sh_number">500</span><span class="sh_symbol">);</span>
        t <span class="sh_symbol">&gt;&gt;=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
    <span class="sh_cbracket">}</span>
    arr<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> num <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">500</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>
<span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_function">iif</span><span class="sh_symbol">(</span><span class="sh_usertype">mint</span><span class="sh_normal"> </span>condition<span class="sh_symbol">,</span> <span class="sh_usertype">mint</span><span class="sh_normal"> </span>x<span class="sh_symbol">)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// condition == 0 ? -x : 0</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>p <span class="sh_symbol">=</span> condition <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">201</span><span class="sh_symbol">,</span>
    y <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_function">sig</span><span class="sh_symbol">((</span>x <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">200</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> p<span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_string">"0.5"</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">return</span> <span class="sh_symbol">(</span>y <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">202</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> p<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>
<span class="sh_usertype">mint</span><span class="sh_normal"> </span>mint<span class="sh_symbol">::</span><span class="sh_keyword">operator</span> <span class="sh_symbol">&gt;=</span> <span class="sh_symbol">(</span><span class="sh_type">int</span> z<span class="sh_symbol">)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// greater than or equal to 0</span>
    <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>z<span class="sh_symbol">)</span> <span class="sh_keyword">return</span> <span class="sh_function">sgn</span><span class="sh_symbol">(*</span><span class="sh_keyword">this</span> <span class="sh_symbol">+</span> <span class="sh_string">"0.0000000000000000000000000000000001"</span><span class="sh_symbol">);</span>
    <span class="sh_keyword">return</span> <span class="sh_symbol">*</span><span class="sh_keyword">this</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>
<span class="sh_type">void</span> <span class="sh_function">lt</span><span class="sh_symbol">(</span><span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_symbol">&amp;</span>x<span class="sh_symbol">,</span> <span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_symbol">&amp;</span>y<span class="sh_symbol">)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// make that x &lt; y</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>s <span class="sh_symbol">=</span> x <span class="sh_symbol">+</span> y<span class="sh_symbol">,</span> c <span class="sh_symbol">=</span> y <span class="sh_symbol">+</span> <span class="sh_symbol">-</span>x<span class="sh_symbol">,</span>
    d <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>c <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
    y <span class="sh_symbol">=</span> y <span class="sh_symbol">+</span> <span class="sh_function">iif</span><span class="sh_symbol">(</span>d<span class="sh_symbol">,</span> c<span class="sh_symbol">);</span>
    x <span class="sh_symbol">=</span> s <span class="sh_symbol">+</span> <span class="sh_symbol">-</span>y<span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>
<span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_function">sqr</span><span class="sh_symbol">(</span><span class="sh_usertype">mint</span><span class="sh_normal"> </span>x<span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>dx <span class="sh_symbol">=</span> x <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">100</span><span class="sh_symbol">,</span>
    y1 <span class="sh_symbol">=</span> <span class="sh_function">sig</span><span class="sh_symbol">(</span>dx <span class="sh_symbol">+</span> <span class="sh_string">"-1.386294361119890618834464242916\</span>
<span class="sh_string">353136151000268720510508241360\</span>
<span class="sh_string">018986787243939389431211726654"</span><span class="sh_symbol">),</span>
    y2 <span class="sh_symbol">=</span> <span class="sh_function">sig</span><span class="sh_symbol">(</span>dx <span class="sh_symbol">+</span> <span class="sh_string">"1.386294361119890618834464242916\</span>
<span class="sh_string">353136151000268720510508241360\</span>
<span class="sh_string">018986787243939389431211726654"</span><span class="sh_symbol">),</span> y <span class="sh_symbol">=</span> y1 <span class="sh_symbol">+</span> <span class="sh_symbol">-</span>y2 <span class="sh_symbol">+</span> <span class="sh_string">"0.6"</span><span class="sh_symbol">;</span>
    y <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>y <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">6</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_symbol">-(</span>y <span class="sh_symbol">+</span> <span class="sh_symbol">(</span>y <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">));</span> <span class="sh_comment">// 62.5y</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>b <span class="sh_symbol">=</span> <span class="sh_function">sig</span><span class="sh_symbol">(</span>y <span class="sh_symbol">+</span> <span class="sh_string">"1.316957896924816708625046347307\</span>
<span class="sh_string">968444026981971467516479768472\</span>
<span class="sh_string">256920460185416443976074219013"</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_string">"-0.788675134594812882254574390250\</span>
<span class="sh_string">978727823800875635063438009301\</span>
<span class="sh_string">163241988836151466672846857698"</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">return</span> b <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">200</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>
<span class="sh_usertype">mint</span><span class="sh_normal"> </span><span class="sh_keyword">operator</span> <span class="sh_symbol">*</span> <span class="sh_symbol">(</span>mint _a<span class="sh_symbol">,</span> mint _b<span class="sh_symbol">)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// multiplication</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>V <span class="sh_symbol">=</span> <span class="sh_function">sqr</span><span class="sh_symbol">(</span>_a<span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_function">sqr</span><span class="sh_symbol">(</span>_b<span class="sh_symbol">);</span>
    <span class="sh_keyword">return</span> <span class="sh_symbol">(</span><span class="sh_function">sqr</span><span class="sh_symbol">(</span>_a <span class="sh_symbol">+</span> _b<span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_symbol">-</span>V<span class="sh_symbol">)</span> <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span> 

<span class="sh_type">void</span> <span class="sh_function">nodes1</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>a <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">(),</span> b <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">();</span>
    <span class="sh_symbol">(-(</span>a <span class="sh_symbol">+</span> b <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">1</span><span class="sh_symbol">)).</span><span class="sh_function">out</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">nodes2</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>a <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">();</span>
    <span class="sh_function">sig</span><span class="sh_symbol">(-(</span>a <span class="sh_symbol">+</span> <span class="sh_symbol">(</span>a <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">4</span><span class="sh_symbol">))).</span><span class="sh_function">out</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">nodes3</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>a <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">();</span>
    <span class="sh_symbol">((</span><span class="sh_function">sgn</span><span class="sh_symbol">(</span>a<span class="sh_symbol">)</span> <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">1</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_string">"-1"</span><span class="sh_symbol">).</span><span class="sh_function">out</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">nodes4</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>a <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">(),</span> b <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>a <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">)</span> <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">202</span><span class="sh_symbol">,</span>
    c <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_function">sig</span><span class="sh_symbol">((</span>a <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">200</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> b<span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_string">"0.5"</span><span class="sh_symbol">;</span>
    <span class="sh_symbol">((</span>c <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">203</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> b <span class="sh_symbol">+</span> a<span class="sh_symbol">).</span><span class="sh_function">out</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">nodes5</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>b<span class="sh_symbol">[</span><span class="sh_number">32</span><span class="sh_symbol">];</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> i <span class="sh_symbol">=</span> <span class="sh_number">31</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i<span class="sh_symbol">--)</span> b<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">();</span>
    <span class="sh_function">combine</span><span class="sh_symbol">(</span>b<span class="sh_symbol">).</span><span class="sh_function">out</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">nodes6</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>a <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">(),</span> b<span class="sh_symbol">[</span><span class="sh_number">32</span><span class="sh_symbol">];</span>
    <span class="sh_function">apart</span><span class="sh_symbol">(</span>a<span class="sh_symbol">,</span> b<span class="sh_symbol">);</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> i <span class="sh_symbol">=</span> <span class="sh_number">31</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i<span class="sh_symbol">--)</span> b<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span><span class="sh_function">out</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">nodes7</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>a <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">(),</span> b <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">(),</span> t<span class="sh_symbol">;</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>ab<span class="sh_symbol">[</span><span class="sh_number">32</span><span class="sh_symbol">],</span> bb<span class="sh_symbol">[</span><span class="sh_number">32</span><span class="sh_symbol">],</span> sb<span class="sh_symbol">[</span><span class="sh_number">32</span><span class="sh_symbol">];</span>
    <span class="sh_function">apart</span><span class="sh_symbol">(</span>a<span class="sh_symbol">,</span> ab<span class="sh_symbol">);</span>
    <span class="sh_function">apart</span><span class="sh_symbol">(</span>b<span class="sh_symbol">,</span> bb<span class="sh_symbol">);</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> i <span class="sh_symbol">=</span> <span class="sh_number">31</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i<span class="sh_symbol">--)</span><span class="sh_cbracket">{</span>
        t <span class="sh_symbol">=</span> ab<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">+</span> bb<span class="sh_symbol">[</span>i<span class="sh_symbol">];</span>
        sb<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> t <span class="sh_symbol">+</span> <span class="sh_symbol">-(</span><span class="sh_function">sgn</span><span class="sh_symbol">(</span>t <span class="sh_symbol">+</span> <span class="sh_string">"-1.70734"</span><span class="sh_symbol">)</span> <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">1</span><span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
    <span class="sh_function">combine</span><span class="sh_symbol">(</span>sb<span class="sh_symbol">).</span><span class="sh_function">out</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">nodes8</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>a <span class="sh_symbol">=</span> <span class="sh_symbol">(</span><span class="sh_function">in</span><span class="sh_symbol">()</span> <span class="sh_symbol">&gt;&gt;</span> <span class="sh_number">200</span><span class="sh_symbol">),</span> b <span class="sh_symbol">=</span> <span class="sh_function">sig</span><span class="sh_symbol">(</span>a <span class="sh_symbol">+</span> <span class="sh_string">"2.063437068895560546727281172620\</span>
<span class="sh_string">131871456591449883392499836032\</span>
<span class="sh_string">692765902842847409911780353006"</span><span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_string">"-0.887298334620741688517926539978\</span>
<span class="sh_string">239961083292170529159082658757\</span>
<span class="sh_string">376611348309193697903351928738"</span><span class="sh_symbol">;</span>
    <span class="sh_symbol">(</span>b <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">200</span><span class="sh_symbol">).</span><span class="sh_function">out</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">nodes9</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>b<span class="sh_symbol">[</span><span class="sh_number">16</span><span class="sh_symbol">];</span>
    <span class="sh_type">int</span> i<span class="sh_symbol">,</span> j<span class="sh_symbol">,</span> k<span class="sh_symbol">,</span> I<span class="sh_symbol">,</span> len<span class="sh_symbol">,</span> sg<span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">16</span><span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span>
        b<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">();</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>I <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> I <span class="sh_symbol">&lt;=</span> <span class="sh_number">3</span><span class="sh_symbol">;</span> I<span class="sh_symbol">++)</span> <span class="sh_comment">// 1 &lt;&lt; 4 = 16</span>
        <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> I<span class="sh_symbol">;</span> i <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i<span class="sh_symbol">--)</span><span class="sh_cbracket">{</span> <span class="sh_comment">// log^2 n</span>
            len <span class="sh_symbol">=</span> <span class="sh_number">1</span> <span class="sh_symbol">&lt;&lt;</span> i<span class="sh_symbol">;</span>
            <span class="sh_keyword">for</span><span class="sh_symbol">(</span>j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;</span> <span class="sh_number">16</span><span class="sh_symbol">;</span> j <span class="sh_symbol">+=</span> len <span class="sh_symbol">&lt;&lt;</span> <span class="sh_number">1</span><span class="sh_symbol">)</span><span class="sh_cbracket">{</span>
                sg <span class="sh_symbol">=</span> j <span class="sh_symbol">&gt;&gt;</span> I <span class="sh_symbol">+</span> <span class="sh_number">1</span> <span class="sh_symbol">&amp;</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>
                <span class="sh_keyword">for</span><span class="sh_symbol">(</span>k <span class="sh_symbol">=</span> j<span class="sh_symbol">;</span> k <span class="sh_symbol">&lt;</span> j <span class="sh_symbol">+</span> len<span class="sh_symbol">;</span> k<span class="sh_symbol">++)</span>
                    sg <span class="sh_symbol">?</span> <span class="sh_function">lt</span><span class="sh_symbol">(</span>b<span class="sh_symbol">[</span>k <span class="sh_symbol">+</span> len<span class="sh_symbol">],</span> b<span class="sh_symbol">[</span>k<span class="sh_symbol">])</span> <span class="sh_symbol">:</span> <span class="sh_function">lt</span><span class="sh_symbol">(</span>b<span class="sh_symbol">[</span>k<span class="sh_symbol">],</span> b<span class="sh_symbol">[</span>k <span class="sh_symbol">+</span> len<span class="sh_symbol">]);</span>
            <span class="sh_cbracket">}</span>
        <span class="sh_cbracket">}</span>

    <span class="sh_keyword">for</span><span class="sh_symbol">(</span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> <span class="sh_number">16</span><span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span>
        b<span class="sh_symbol">[</span>i<span class="sh_symbol">].</span><span class="sh_function">out</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">void</span> <span class="sh_function">nodes10</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>a <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">(),</span> b <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">(),</span> mod <span class="sh_symbol">=</span> <span class="sh_function">in</span><span class="sh_symbol">(),</span> _mod <span class="sh_symbol">=</span> <span class="sh_symbol">-</span>mod<span class="sh_symbol">;</span>
    <span class="sh_usertype">mint</span><span class="sh_normal"> </span>s<span class="sh_symbol">,</span> g<span class="sh_symbol">,</span> t<span class="sh_symbol">;</span>
    s <span class="sh_symbol">=</span> a <span class="sh_symbol">*</span> b <span class="sh_symbol">+</span> <span class="sh_string">"0.0170734"</span><span class="sh_symbol">;</span>
    <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> i <span class="sh_symbol">=</span> <span class="sh_number">63</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&gt;</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i<span class="sh_symbol">--)</span><span class="sh_cbracket">{</span>
        t <span class="sh_symbol">=</span> _mod <span class="sh_symbol">&lt;&lt;</span> i<span class="sh_symbol">;</span>
        g <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>s <span class="sh_symbol">+</span> t <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
        s <span class="sh_symbol">=</span> s <span class="sh_symbol">+</span> <span class="sh_function">iif</span><span class="sh_symbol">(</span>g <span class="sh_symbol">+</span> <span class="sh_string">"-1"</span><span class="sh_symbol">,</span> <span class="sh_symbol">-</span>t<span class="sh_symbol">);</span>
    <span class="sh_cbracket">}</span>
    g <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>s <span class="sh_symbol">+</span> _mod <span class="sh_symbol">&gt;=</span> <span class="sh_number">0</span><span class="sh_symbol">);</span>
    s <span class="sh_symbol">=</span> s <span class="sh_symbol">+</span> <span class="sh_function">iif</span><span class="sh_symbol">(</span>g <span class="sh_symbol">+</span> <span class="sh_string">"-1"</span><span class="sh_symbol">,</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">+</span> <span class="sh_string">"-0.0170734"</span><span class="sh_symbol">;</span>
    s<span class="sh_symbol">.</span><span class="sh_function">out</span><span class="sh_symbol">();</span>
<span class="sh_cbracket">}</span>

<span class="sh_type">int</span> <span class="sh_function">main</span><span class="sh_symbol">()</span><span class="sh_cbracket">{</span>
    fout <span class="sh_symbol">=</span> <span class="sh_function">fopen</span><span class="sh_symbol">(</span><span class="sh_string">"nodes1.out"</span><span class="sh_symbol">,</span> <span class="sh_string">"w"</span><span class="sh_symbol">);</span> <span class="sh_function">nodes1</span><span class="sh_symbol">();</span> <span class="sh_function">clear</span><span class="sh_symbol">();</span>
    fout <span class="sh_symbol">=</span> <span class="sh_function">fopen</span><span class="sh_symbol">(</span><span class="sh_string">"nodes2.out"</span><span class="sh_symbol">,</span> <span class="sh_string">"w"</span><span class="sh_symbol">);</span> <span class="sh_function">nodes2</span><span class="sh_symbol">();</span> <span class="sh_function">clear</span><span class="sh_symbol">();</span>
    fout <span class="sh_symbol">=</span> <span class="sh_function">fopen</span><span class="sh_symbol">(</span><span class="sh_string">"nodes3.out"</span><span class="sh_symbol">,</span> <span class="sh_string">"w"</span><span class="sh_symbol">);</span> <span class="sh_function">nodes3</span><span class="sh_symbol">();</span> <span class="sh_function">clear</span><span class="sh_symbol">();</span>
    fout <span class="sh_symbol">=</span> <span class="sh_function">fopen</span><span class="sh_symbol">(</span><span class="sh_string">"nodes4.out"</span><span class="sh_symbol">,</span> <span class="sh_string">"w"</span><span class="sh_symbol">);</span> <span class="sh_function">nodes4</span><span class="sh_symbol">();</span> <span class="sh_function">clear</span><span class="sh_symbol">();</span>
    fout <span class="sh_symbol">=</span> <span class="sh_function">fopen</span><span class="sh_symbol">(</span><span class="sh_string">"nodes5.out"</span><span class="sh_symbol">,</span> <span class="sh_string">"w"</span><span class="sh_symbol">);</span> <span class="sh_function">nodes5</span><span class="sh_symbol">();</span> <span class="sh_function">clear</span><span class="sh_symbol">();</span>
    fout <span class="sh_symbol">=</span> <span class="sh_function">fopen</span><span class="sh_symbol">(</span><span class="sh_string">"nodes6.out"</span><span class="sh_symbol">,</span> <span class="sh_string">"w"</span><span class="sh_symbol">);</span> <span class="sh_function">nodes6</span><span class="sh_symbol">();</span> <span class="sh_function">clear</span><span class="sh_symbol">();</span>
    fout <span class="sh_symbol">=</span> <span class="sh_function">fopen</span><span class="sh_symbol">(</span><span class="sh_string">"nodes7.out"</span><span class="sh_symbol">,</span> <span class="sh_string">"w"</span><span class="sh_symbol">);</span> <span class="sh_function">nodes7</span><span class="sh_symbol">();</span> <span class="sh_function">clear</span><span class="sh_symbol">();</span>
    fout <span class="sh_symbol">=</span> <span class="sh_function">fopen</span><span class="sh_symbol">(</span><span class="sh_string">"nodes8.out"</span><span class="sh_symbol">,</span> <span class="sh_string">"w"</span><span class="sh_symbol">);</span> <span class="sh_function">nodes8</span><span class="sh_symbol">();</span> <span class="sh_function">clear</span><span class="sh_symbol">();</span>
    fout <span class="sh_symbol">=</span> <span class="sh_function">fopen</span><span class="sh_symbol">(</span><span class="sh_string">"nodes9.out"</span><span class="sh_symbol">,</span> <span class="sh_string">"w"</span><span class="sh_symbol">);</span> <span class="sh_function">nodes9</span><span class="sh_symbol">();</span> <span class="sh_function">clear</span><span class="sh_symbol">();</span>
    fout <span class="sh_symbol">=</span> <span class="sh_function">fopen</span><span class="sh_symbol">(</span><span class="sh_string">"nodes10.out"</span><span class="sh_symbol">,</span> <span class="sh_string">"w"</span><span class="sh_symbol">);</span> <span class="sh_function">nodes10</span><span class="sh_symbol">();</span> <span class="sh_function">clear</span><span class="sh_symbol">();</span>
    <span class="sh_keyword">return</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>
<span class="sh_cbracket">}</span>

</code></pre></div>
